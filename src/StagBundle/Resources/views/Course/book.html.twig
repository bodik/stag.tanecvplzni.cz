{% extends 'base.html.twig' %}

{% block body %}
<div class="courses">

	{% include 'StagBundle:Course:toolbox.html.twig' %}
	
	<ul class="list-inline well">
		<li><strong>Course:</strong> {{course.name}}</li>
		<li><strong>Type:</strong> {{course.type}}</li>
		<li><strong>Level:</strong> {{course.level}}</li>
		<li><strong>Lecturer:</strong> {{course.lecturer}}</li>
		<li><strong>Place:</strong> {{course.place}}</li>
	</ul>
	
	<div class="row" style="padding-bottom: 1em">
		<div class="col-md-6">
			<table class="table table-stripped">
				<thead><tr>
					<th>cas</th>
					<th>level</th>
					<th>lecturer</th>
					<th>description</th>
					<th></th>
				</tr></thead>
				
				<tbody>
				{% for tmp in course.lessons %}
					<tr>
					<td>{{ tmp.time|date('d.m.Y H:i') }} - {{ tmp.time|date_modify(tmp.length~" minutes")|date('H:i') }}</td>
					<td>{{ tmp.level }}</dt>
					<td>{{ tmp.lecturer }}</dt>
					<td>{{ tmp.description }}</dt>
					<td>
						<a class="btn btn-xs btn-primary" href="{{ path('lesson_edit', {'id': tmp.id}) }}"><span class="glyphicon glyphicon-edit"></span> Edit</a>
						{{ render(controller("StagBundle:Lesson:delete", {'id': tmp.id})) }}
					</td>
					</tr>
				{% endfor %}
				</tbody>
			</table>
		</div>
		
		<div class="col-md-6">
			<table class="table table-stripped">
				<thead><tr>
					<th>name</th>
					<th>price</th>
					<th></th>
				</tr></thead>
				
				<tbody>
				{% for tmp in course.tickets %}
					<tr>
					<td>{{ tmp.name }}</dt>
					<td>{{ tmp.price }}</dt>
					<td>
						<a class="btn btn-xs btn-info" href="{{ path('participant_application', {'ticket_id': tmp.id}) }}"><span class="glyphicon glyphicon-plus"></span> Enroll</a>						
						<a class="btn btn-xs btn-primary" href="{{ path('ticket_edit', {'id': tmp.id}) }}"><span class="glyphicon glyphicon-edit"></span> Edit</a>
						{{ render(controller("StagBundle:Ticket:delete", {'id': tmp.id})) }}
					</td>
					</tr>
				{% endfor %}
				</tbody>
			</table>
		</div>
	
	</div><!-- lessons and tickets row -->


	<table class="table">
		<tr>
			<th>id</td>
			<th>gn</th>
			<th>sn</th>
			<th>email</th>
			<th>phoneNumber</th>
			<th>gender</th>
			<th>partner</th>
			<th>note</th>
			<th>deposit</th>
			<th>payment</th>
			<th>created</th>
			<th class="hidden-print"></th>
		<tr>
		
		{% for ticket in course.tickets %}
		{% for participant in ticket.participants %}
		<tr>
			<td>{{ participant.id }}</td>
			<td>{{ participant.gn }}</td>
			<td>{{ participant.sn }}</td>
			<td>{{ participant.email }}</td>
			<td>{{ participant.phoneNumber }}</td>
			<td>{{ participant.gender }}</td>
			<td>{{ participant.partner }}</td>
			<td>{{ participant.note }}</td>

			<td>
				{% if participant.deposit == "wire" %}
					<span class="glyphicon glyphicon-retweet text-success" title="Wire-transfer"></span>
				{% elseif participant.deposit == "cash" %}
					<span class="glyphicon glyphicon-hand-right text-success" title="Cash"></span>
				{% else %}
					{{ participant.deposit }}
				{% endif %}

				{% if participant.deposit %}
					{{ render(controller("StagBundle:Participant:deposit", {'id': participant.id, 'value': null})) }}
				{% else %}
					{{ render(controller("StagBundle:Participant:deposit", {'id': participant.id, 'value': 'wire'})) }}
					{{ render(controller("StagBundle:Participant:deposit", {'id': participant.id, 'value': 'cash'})) }}
				{% endif %}
			</td>


			<td>
				{% if participant.payment == "wire" %}
					<span class="glyphicon glyphicon-retweet text-success" title="Wire-transfer"></span>
				{% elseif participant.payment == "cash" %}
					<span class="glyphicon glyphicon-hand-right text-success" title="Cash"></span>
				{% else %}
					{{ participant.payment }}
				{% endif %}

				{% if participant.payment %}
					{{ render(controller("StagBundle:Participant:payment", {'id': participant.id, 'value': null})) }}
				{% else %}
					{{ render(controller("StagBundle:Participant:payment", {'id': participant.id, 'value': 'wire'})) }}
					{{ render(controller("StagBundle:Participant:payment", {'id': participant.id, 'value': 'cash'})) }}
				{% endif %}
			</td>


			<td>{{ participant.created|date('c')[0:10] }}</td>
			<td class="hidden-print">
				<a class="btn btn-xs btn-primary" href="{{ path('participant_edit', {'id': participant.id}) }}"><span class="glyphicon glyphicon-edit"></span> Edit</a>
				{{ render(controller("StagBundle:Participant:delete", {'id': participant.id})) }}
			</td>
		<tr>
		{% endfor %}
		{% endfor %}
	</table>


</div>
{% endblock %}

{% block stylesheets %}
{% endblock %}
