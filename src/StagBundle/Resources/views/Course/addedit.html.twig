{% extends 'base.html.twig' %}


{% block stylesheets %}
<script src="{{ asset('bundles/stag/jscolor/jscolor.min.js') }}"></script>

<link rel="stylesheet" href="{{ asset('bundles/stag/image-picker/image-picker.css') }}" />
<script src="{{ asset('bundles/stag/image-picker/image-picker.min.js') }}"></script>

<link rel="stylesheet" href="{{ asset('bundles/stag/selectize/selectize.bootstrap3.css') }}" />
<script src="{{ asset('bundles/stag/selectize/selectize.js') }}"></script>


<style>
.thumbnails li img { width: 100px; }
.help-block { margin-top: 0; }
</style>
{% endblock %}

{% block body %}
<div class="courses">
	<h1>Course add</h1>
	{{ form_start(form) }}
	
        {{ form_row(form.name) }}
        <div class="form-group">
		{{ form_label(form.level) }}
		{{ form_errors(form.level) }}
		<div class="col-sm-10">
			{{ form_widget(form.level) }}
			<div class="help-block">Fill in a dances when editing a "party".</div>
		</div>
	</div>

	<div class="form-group">
		{{ form_label(form.description) }}
		{{ form_errors(form.description) }}
		<div class="col-sm-10">
			{{ form_widget(form.description) }}
			<div class="help-block">Supports markdown.</div>
		</div>
	</div>

	<div class="form-group">
		{{ form_label(form.lecturer) }}
		{{ form_errors(form.lecturer) }}
		<div class="col-sm-10">
			{{ form_widget(form.lecturer) }}
			<div class="help-block">Supports search and select from already existing items. Fill in a DJs when editing a "party".</div>
		</div>
	</div>

	<div class="form-group">
		{{ form_label(form.place) }}
		{{ form_errors(form.place) }}
		<div class="col-sm-10">
			{{ form_widget(form.place) }}
			<div class="help-block">Supports search and select from already existing items.</div>
		</div>
	</div>

	{{ form_row(form.type) }}
        {{ form_row(form.pair) }}
	{{ form_row(form.priceSingle) }}
	{{ form_row(form.pricePair) }}
	{{ form_row(form.color) }}
	{{ form_row(form.applEmailText) }}

        {% do form.pictureRef.setRendered %}
	<div class="form-group">
		<label class="col-sm-2 control-label required" for="course_pictureRef">PictureRef</label>
		<div class="col-sm-10">
			<select id="image-picker" class="image-picker show-html" name="course[pictureRef]">
				<option value=""></option>
				{% for blob in blobs %}
				<option 
					{% if form.pictureRef.vars.value == blob.id %} selected {% endif %}
					data-img-src="{{ path('blob_get', {'id': blob.fileName}) }}" 
					data-img-alt="{{ blob.fileName }}"
					value="{{ blob.id }}">{{ blob.fileName }}</option>
				{% endfor %}
			</select>
		</div>
	</div>

	{% do form.save.setRendered %}
	<div class="form-group">
		<div class="col-sm-2"></div>
		<div class="col-sm-10"><button type="submit" id="course_save" name="course[save]" class="btn-default btn">Save</button></div>
	</div>

	{{ form_end(form) }}

</div>

<script>
$(document).ready(function() {

	$("#image-picker").imagepicker();

	$("#course_place").selectize({
		plugins: ['restore_on_backspace'],
		create: true,
		maxItems: 1,
		delimiter: null,
		createOnBlur: true,

		valueField: "value",
		labelField: "value",
		searchField: "value",
		load: function(query, callback) {
			if (!query.length) return callback();
			$.ajax({
				url: "{{ path('course_suggest_place') }}?",
				type: "GET",
				error: function() { callback(); },
				success: function(res) { callback(res); }
			});
		},
	});
	
	$("#course_lecturer").selectize({
		plugins: ['restore_on_backspace'],
		create: true,
		maxItems: 1,
		delimiter: null,
		createOnBlur: true,

		valueField: "value",
		labelField: "value",
		searchField: "value",
		load: function(query, callback) {
			if (!query.length) return callback();
			$.ajax({
				url: "{{ path('course_suggest_lecturer') }}?",
				type: "GET",
				error: function() { callback(); },
				success: function(res) { callback(res); }
			});
		},
	});
	
});
</script>

{% endblock %}

