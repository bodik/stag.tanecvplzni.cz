{% extends 'base.html.twig' %}


{% block stylesheets %}
<script src="{{ asset('bundles/stag/jscolor/jscolor.min.js') }}"></script>

<link rel="stylesheet" href="{{ asset('bundles/stag/image-picker/image-picker.css') }}" />
<script src="{{ asset('bundles/stag/image-picker/image-picker.min.js') }}"></script>

<link rel="stylesheet" href="{{ asset('bundles/stag/selectize/selectize.bootstrap3.css') }}" />
<script src="{{ asset('bundles/stag/selectize/selectize.js') }}"></script>


<style>
.thumbnails li img { width: 100px; }
</style>
{% endblock %}

{% block body %}
<div class="courses">
	<h1>Course add</h1>
	{{ form_start(form) }}
	
	{% do form.pictureRef.setRendered %}
	{% do form.save.setRendered %}
	
        {{ form_widget(form) }}
        
	<div class="form-group">
		<label class="col-sm-2 control-label required" for="course_pictureRef">PictureRef</label>
	
		<div class="col-sm-10">
		<select id="image-picker" class="image-picker show-html" name="course[pictureRef]">
			<option value=""></option>
			{% for blob in blobs %}
			<option 
				{% if form.pictureRef.vars.value == blob.id %} selected {% endif %}
				data-img-src="{{ path('blob_get', {'id': blob.fileName}) }}" 
				data-img-alt="{{ blob.fileName }}"
				value="{{ blob.id }}">{{ blob.fileName }}</option>
			{% endfor %}
		</select>
		
		</div>
	</div>
	
	<div class="form-group">
		<div class="col-sm-2"></div>
		<div class="col-sm-10"><button type="submit" id="course_save" name="course[save]" class="btn-default btn">Save</button></div>
	</div>
	
	{{ form_end(form) }}

</div>

<script>
$(document).ready(function() {

	$("#image-picker").imagepicker();
	$("#course_place").selectize({
		create: true,
		maxItems: 1,
		delimiter: null,
		createOnBlur: true,

		valueField: "value",
		labelField: "value",
		searchField: "value",
		load: function(query, callback) {
			if (!query.length) return callback();
			$.ajax({
				url: "{{ path('course_suggest_place') }}?",
				type: "GET",
				error: function() { callback(); },
				success: function(res) { callback(res); }
			});
		},
	});
	
	$("#course_lecturer").selectize({
		create: true,
		maxItems: 1,
		delimiter: null,
		createOnBlur: true,

		valueField: "value",
		labelField: "value",
		searchField: "value",
		load: function(query, callback) {
			if (!query.length) return callback();
			$.ajax({
				url: "{{ path('course_suggest_lecturer') }}?",
				type: "GET",
				error: function() { callback(); },
				success: function(res) { callback(res); }
			});
		},
	});
	
});
</script>

{% endblock %}

